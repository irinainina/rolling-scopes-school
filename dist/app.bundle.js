!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n=document.querySelector(".canvas-active"),a=n.getContext("2d");let o,r,c=!1;function l(){const e=document.getElementsByName("size");let t=1;return e.forEach(e=>{e.checked&&(t=+e.value)}),t}function i(){let e;return document.getElementsByName("resize").forEach(t=>{t.checked&&(e=t.value)}),e}function s(){const e=document.createElement("canvas"),t=e.getContext("2d"),o=document.querySelectorAll(".canvas2"),r=i(),c=(r-n.width)/2;t.drawImage(n,0,0),n.width=n.height=r,a.drawImage(e,c,c),o.forEach(n=>{t.drawImage(n,0,0),n.width=n.height=r,n.getContext("2d").drawImage(e,c,c)});const l=document.querySelector(".layer");l.width=l.height=r}function d(){const e=document.querySelector(".canvas-size span");let t=i();e.innerText=`[${t}x${t}]`}const u=document.getElementsByName("resize");function m(){return n.offsetWidth/n.width}function h(){let e;return document.getElementsByName("tool").forEach(t=>{t.checked&&(e=t.value)}),e}function f(){let e;return e=document.querySelector(".active-color").value}function g(e,t,n){if(t<0||n<0||t>=e.width||n>=e.height)return[-1,-1,-1,-1];{const a=4*(n*e.width+t);return e.data.slice(a,a+4)}}function v(e,t,n,a){const o=4*(n*e.width+t);e.data[o+0]=a[0],e.data[o+1]=a[1],e.data[o+2]=a[2],e.data[o+3]=a[3]}function y(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function p(e,t,n,a){const o=e.getImageData(0,0,e.canvas.width,e.canvas.height),r=g(o,t,n);if(!y(r,a)){const c=[t,n];for(;c.length>0;){const e=c.pop(),t=c.pop();y(g(o,t,e),r)&&(v(o,t,e,a),c.push(t+1,e),c.push(t-1,e),c.push(t,e+1),c.push(t,e-1))}e.putImageData(o,0,0)}}function w(e){if("eraser"!==h()||!c)return;let t=l();const o=Math.floor(e.offsetX/m()/t)*t,r=Math.floor(e.offsetY/m()/t)*t;e.ctrlKey?a.clearRect(0,0,n.width,n.height):a.clearRect(o,r,t,t)}u.forEach(e=>e.addEventListener("click",s)),u.forEach(e=>e.addEventListener("click",d)),n.addEventListener("mousemove",()=>{let e=l();o=Math.floor(event.offsetX/m()/e)*e,r=Math.floor(event.offsetY/m()/e)*e}),n.addEventListener("mousemove",function(){const e=document.querySelector(".coordinates span");e.parentNode.style.opacity="1",e.innerText=`${o}:${r}`,n.addEventListener("mouseleave",()=>e.parentNode.style.opacity="0")}),document.querySelector(".rotate").addEventListener("click",function(){const e=document.querySelector(".active-color"),t=document.querySelector(".prev-color");let n;n=e.value,e.value=t.value,t.value=n}),n.addEventListener("mousedown",()=>{c=!0}),n.addEventListener("mouseup",()=>{c=!1}),n.parentNode.addEventListener("mouseleave",()=>{c=!1});let S=n;const E={};function L(e,t,n,o){let r=l(),c=Math.abs(n-e),i=Math.abs(o-t),s=e<n?1:-1,d=t<o?1:-1,u=c-i;for(a.fillRect(n,o,r,r);e!=n||t!=o;){a.fillRect(e,t,r,r);let n=2*u;n>-i&&(u-=i,e+=s),n<c&&(u+=c,t+=d)}}function x(e,t,n){for(var a=n,o=0,r=1-a;a>=o;)q(a,o,e,t),o+=1,r+=r<0?2*o+1:2*(o- --a)+1,q(a,o,e,t)}function q(e,t,n,o){a.fillRect(e+n,t+o,1,1),a.fillRect(n+t,e+o,1,1),a.fillRect(n-e,o+t,1,1),a.fillRect(n-t,o+e,1,1),a.fillRect(n-e,o-t,1,1),a.fillRect(n-t,o-e,1,1),a.fillRect(e+n,o-t,1,1),a.fillRect(n+t,o-e,1,1)}function I(e,t,n,a){var o=0,r=a,c=n*n,l=a*a,i=0,s=2*c*r;b(o,r,e,t);for(var d=l-c*a+.25*c;i<s;)i+=2*l,d<0?d=d+l+i:(r--,d=d+l+i-(s-=2*c)),b(++o,r,e,t);for(d=l*((o+.5)*(o+.5))+c*((r-1)*(r-1))-c*l;r>0;)s-=2*c,d>0?d=d+c-s:(o++,d=d+c-s+(i+=2*l)),b(o,--r,e,t)}function b(e,t,n,o){a.fillRect(n+e,o+t,1,1),a.fillRect(n-e,o+t,1,1),a.fillRect(n+e,o-t,1,1),a.fillRect(n-e,o-t,1,1)}function R(){if("shape"!==h()||!c)return;a.putImageData(S,0,0);p(a,o,r,[79,181,227,115]);let e=a.getImageData(E.x,E.y,n.width,n.height);a.putImageData(e,x2,y2)}function k(e,t,n){e/=255,t/=255,n/=255;let a,o,r=Math.max(e,t,n),c=Math.min(e,t,n),l=(r+c)/2;if(r==c)a=o=0;else{let i=r-c;switch(o=l>.5?i/(2-r-c):i/(r+c),r){case e:a=(t-n)/i+(t<n?6:0);break;case t:a=(n-e)/i+2;break;case n:a=(e-t)/i+4}a/=6}return[360*a,100*o,100*l]}n.addEventListener("mousedown",()=>{a.fillStyle=f(),S=a.getImageData(0,0,n.width,n.height),E.x=o,E.y=r}),document.querySelector(".rotation").addEventListener("mousedown",function(e){const t=new Image;t.src=n.toDataURL(),a.save(),e.ctrlKey?(a.translate(n.width,1),a.rotate(Math.PI/2)):(a.translate(1,n.width),a.rotate(3*Math.PI/2)),a.clearRect(0,0,n.width,n.height),t.onload=function(){a.drawImage(t,0,0),a.restore()}}),document.querySelector(".flipflop").addEventListener("mousedown",function(e){const t=new Image;t.src=n.toDataURL(),a.save(),e.ctrlKey?(a.translate(0,n.width),a.scale(1,-1)):(a.translate(n.width,0),a.scale(-1,1)),a.clearRect(0,0,n.width,n.height),t.onload=function(){a.drawImage(t,0,0),a.restore()}});const C=document.querySelector(".change-hotkeys"),M=document.querySelector(".change-hotkey"),A=document.querySelector(".cancel");function T(e){const t=document.querySelectorAll(".setting-container"),n=document.querySelectorAll(".setting-btn"),a=e.target.parentNode;e.target.classList.contains("btn-show")||(n.forEach(e=>{e.classList.remove("btn-show")}),e.target.classList.add("btn-show")),a.classList.contains("setting-hide")?(t.forEach(e=>{e.classList.remove("setting-hide")}),a.classList.contains("setting-show")||t.forEach(e=>{e.classList.remove("setting-show"),e.lastElementChild.classList.remove("setting-opacity"),e.lastElementChild.classList.add("setting-none"),a.classList.add("setting-show"),a.lastElementChild.classList.remove("setting-none"),a.lastElementChild.classList.add("setting-opacity")})):a.classList.contains("setting-show")?t.forEach(e=>{e.classList.add("setting-hide")}):t.forEach(e=>{e.classList.remove("setting-show"),e.lastElementChild.classList.remove("setting-opacity"),e.lastElementChild.classList.add("setting-none"),a.classList.add("setting-show"),a.lastElementChild.classList.remove("setting-none"),a.lastElementChild.classList.add("setting-opacity")})}C.addEventListener("click",function(e){if(!e.target.classList.contains("hotkey-input"))return;const t=document.querySelector(".inform"),n=document.querySelector(".btn-hotkey"),a=document.querySelectorAll(".hotkey-value"),o=[];a.forEach(e=>o.push(e.innerText)),e.target.addEventListener("input",()=>{let a=e.target.value;a.match(/[a-zA-Z]/)||(t.innerText="Please use only Latin letters"),a.match(/[a-z]/)&&(a=a.toUpperCase()),o.includes(a)?t.innerText="This letter already in use. Please choose another letter":a.match(/[A-Z]/)&&(t.innerText="Press the button to change the hotkey"),n.addEventListener("click",()=>{e.target.previousElementSibling.innerText=a,e.target.value="",t.innerText="The hotkey is changed successfully",document.querySelectorAll(".tooltip-shortcut").forEach(t=>{t.dataset.tool===e.target.previousElementSibling.previousElementSibling.innerText&&(t.innerText=`(${a})`)})})})}),M.addEventListener("click",()=>{C.classList.remove("hide")}),A.addEventListener("click",()=>{C.classList.add("hide")}),window.addEventListener("keydown",function(e){const t=document.querySelector(".tools"),n=document.querySelectorAll(".hotkey-value"),a=document.querySelectorAll(".hotkey-name");for(let o=0;o<n.length;o++)e.code===`Key${n[o].innerText}`&&(t.querySelector(`input[value=${a[o].innerText}]`).checked=!0)});const D=document.querySelector(".setting-resize-btn"),N=document.querySelector(".setting-save-btn"),$=document.querySelector(".setting-import-btn");function z(){document.querySelectorAll(".preview").forEach((e,t)=>{e.querySelector(".number").innerText=t+1})}function P(){const e=document.querySelectorAll(".preview");e.forEach((t,n)=>{t.classList.remove("preview-active"),n===e.length-1&&t.classList.add("preview-active")})}function U(){document.querySelectorAll(".preview").forEach(e=>{if(e.classList.contains("preview-active")){const t=e.querySelector(".canvas2"),a=t.getContext("2d");a.clearRect(0,0,t.width,t.height),a.drawImage(n,0,0)}})}D.addEventListener("click",T),N.addEventListener("click",T),$.addEventListener("click",T),n.addEventListener("mousewheel",function(e){e=window.event;let t=Math.max(-1,Math.min(1,e.wheelDelta));return n.style.width=Math.max(32,Math.min(640,n.offsetWidth+32*t))+"px",n.style.height=Math.max(32,Math.min(640,n.offsetHeight+32*t))+"px",!1}),n.addEventListener("mousemove",function(e){if("pen"!==h()||!c)return;const t={};t.x=Math.floor(e.offsetX/m()/l())*l(),t.y=Math.floor(e.offsetY/m()/l())*l(),L(E.x,E.y,t.x,t.y),E.x=t.x,E.y=t.y}),n.addEventListener("mousemove",function(e){if("mirror"!==h()||!c)return;a.fillStyle=f();let t=l();const o=Math.floor(e.offsetX/m()/t)*t,r=Math.abs(n.width-o-l()),i=Math.floor(e.offsetY/m()/t)*t;if(e.ctrlKey){const e=Math.abs(n.width-i-l());a.fillRect(o,i,t,t),a.fillRect(o,e,t,t)}else if(e.shiftKey){const e=Math.abs(n.width-o-l()),r=Math.abs(n.width-i-l());a.fillRect(o,i,t,t),a.fillRect(e,i,t,t),a.fillRect(o,r,t,t),a.fillRect(e,r,t,t)}else a.fillRect(o,i,t,t),a.fillRect(r,i,t,t)}),n.addEventListener("mousedown",function(){if("bucket"===h())if(event.ctrlKey)a.fillStyle=f(),a.fillRect(0,0,n.width,n.height);else{let e=function(e){let t=e.substring(1).split("");return 3===t.length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t,255]}(f());p(a,o,r,e)}}),n.addEventListener("mousedown",w),n.addEventListener("mousemove",w),n.addEventListener("mousedown",function(e){if("brush"!==h())return;a.fillStyle=f();let t=e.offsetX/m(),o=e.offsetY/m(),r=a.getImageData(t,o,1,1).data.join(","),c=n.width;for(let e=0;e<c;e++)for(let t=0;t<c;t++)a.getImageData(e,t,1,1).data.join(",")===r&&a.fillRect(e,t,1,1)}),n.addEventListener("mousemove",function(e){if("stroke"!==h()||!c)return;a.putImageData(S,0,0);const t={};t.x=Math.floor(e.offsetX/m()/l())*l(),t.y=Math.floor(e.offsetY/m()/l())*l(),L(E.x,E.y,t.x,t.y)}),n.addEventListener("mousemove",function(e){if("circle"!==h()||!c)return;a.putImageData(S,0,0),a.fillStyle=f();const t={};let n;t.x=Math.floor(e.offsetX/m()/l())*l(),t.y=Math.floor(e.offsetY/m()/l())*l();let i=Math.floor(Math.abs(t.x-E.x)/2),s=Math.floor(Math.abs(t.y-E.y)/2);n=i<s?i:s,E.x<t.x&&E.y<t.y?e.shiftKey?x(o-n,r-n,n):I(o-i,r-s,i,s):E.x>t.x&&E.y>t.y?e.shiftKey?x(E.x-n,E.y-n,n):I(E.x-i,E.y-s,i,s):E.x<t.x&&E.y>t.y?e.shiftKey?x(o-n,E.y-n,n):I(o-i,E.y-s,i,s):E.x>t.x&&E.y<t.y&&(e.shiftKey?x(E.x-n,r-n,n):I(E.x-i,r-s,i,s))}),n.addEventListener("mousemove",function(e){if("rectangle"!==h()||!c)return;a.putImageData(S,0,0),a.lineWidth=l(),a.strokeStyle=f();let t=Math.floor(e.offsetX/m()),n=Math.floor(e.offsetY/m()),o=t-E.x,r=n-E.y;e.shiftKey&&(Math.abs(o)<Math.abs(r)?r=r>0?Math.abs(o):-Math.abs(o):Math.abs(r)<Math.abs(o)&&(o=o>0?Math.abs(r):-Math.abs(r))),1===l()||3===l()?a.strokeRect(E.x+.5,E.y+.5,o,r):a.strokeRect(E.x,E.y,o,r)}),n.addEventListener("mousemove",function(){if("move"!==h()||!c)return;a.putImageData(S,0,0);let e=o-E.x,t=r-E.y,l=a.getImageData(0,0,n.width-e,n.height-t);a.clearRect(0,0,n.width,n.height),a.putImageData(l,e,t)}),n.addEventListener("mousemove",R),n.addEventListener("mousedown",R),n.addEventListener("mousedown",function(){if("color-picker"!==h()||!c)return;const e=document.querySelector(".active-color"),t=Math.floor(event.offsetX/m()),n=Math.floor(event.offsetY/m());let o=a.getImageData(t,n,1,1).data;if(0===o[3])return;let r=o[0].toString(16);r=1===r.length?"0"+r:r;let l=o[1].toString(16);l=1===l.length?"0"+l:l;let i=o[2].toString(16),s=`#${r}${l}${i=1===i.length?"0"+i:i}`;e.value=s}),n.addEventListener("mousedown",function(e){if("lighten"!==h()||!c)return;let t=l();for(let n=o;n<o+t;n++)for(let o=r;o<r+t;o++){let t=a.getImageData(n,o,1,1).data;if(0===t[3])return;let[r,c,l]=k(t[0],t[1],t[2]);e.ctrlKey?a.fillStyle=`hsl(${r}, ${c}%, ${l>6?l-=5:1}%)`:a.fillStyle=`hsl(${r}, ${c}%, ${l<94?l+=5:99}%)`,a.fillRect(n,o,1,1)}}),n.addEventListener("mousemove",function(e){if("dithering"!==h()||!c)return;const t=document.querySelector(".prev-color");let n=l();const o=Math.floor(e.offsetX/m()),r=Math.floor(e.offsetY/m());if(e.ctrlKey)for(let e=o;e<o+n;e++)for(let o=r;o<r+n;o++)e%2!=o%2?(a.fillStyle=f(),a.fillRect(e,o,1,1)):(a.fillStyle=t.value,a.fillRect(e,o,1,1));else for(let e=o;e<o+n;e++)for(let t=r;t<r+n;t++)e%2!=t%2?(a.fillStyle=f(),a.fillRect(e,t,1,1)):a.clearRect(e,t,1,1)}),n.addEventListener("mouseup",U);const B=document.querySelector(".previews-list");function K(){const e=B.querySelector(".preview-container").cloneNode(!0);B.appendChild(e),a.clearRect(0,0,n.width,n.height),z(),P()}B.addEventListener("click",function(e){e.target.classList.contains("canvas2")&&(document.querySelectorAll(".preview").forEach(e=>{e.classList.contains("preview-active")&&e.classList.remove("preview-active")}),e.target.parentNode.classList.add("preview-active"),a.clearRect(0,0,n.width,n.height),a.drawImage(e.target,0,0))});const j=document.querySelector(".add-frame");j.addEventListener("click",K),B.addEventListener("click",function(e){e.target.classList.contains("delete")&&B.children.length>1&&(e.target.parentNode.classList.contains("preview-active")&&a.clearRect(0,0,n.width,n.height),e.target.parentNode.parentNode.remove(),z(),Q(),P())}),B.addEventListener("mouseover",function(e){if(!e.target.classList.contains("move"))return;let t=e.target.parentNode;e.target.onmousedown=function(){t.style.position="absolute",t.style.zIndex=100,t.parentNode.classList.add("preview-container-active"),document.onmousemove=function(e){!function(e){t.style.top=e.pageY-t.offsetHeight/2-t.parentNode.offsetTop+"px",t.style.left="-3px"}(e)}},t.onmouseup=function(){document.querySelectorAll(".preview-container").forEach(e=>{let n=t.offsetTop+t.parentNode.offsetTop,a=e.offsetTop;if(n>a-45&&n<a+45){let n=e,a=e.firstElementChild,o=t.parentNode,r=t;t.style.top="0px",t.style.left="0px",n.appendChild(r),o.appendChild(a),o.classList.remove("preview-container-active")}else t.parentNode.appendChild(t),t.parentNode.classList.remove("preview-container-active")}),t.style.zIndex=1,document.onmousemove=null,t.onmouseup=null,z(),Q(),P()}}),B.addEventListener("click",function(e){if(e.target.classList.contains("copy")){const t=e.target.parentNode.parentNode.cloneNode(!0),n=e.target.parentNode.parentNode,a=e.target.parentNode.querySelector("canvas");t.querySelector("canvas").getContext("2d").drawImage(a,0,0),B.insertBefore(t,n),z(),Q(),P()}});const Y=document.querySelector(".layer"),X=document.querySelector(".layer-management-layer-container");function O(){document.querySelectorAll(".layer-management-layer").forEach(e=>{e.classList.contains("layer-management-layer-active")&&e.classList.remove("layer-management-layer-active")}),X.firstElementChild.classList.add("layer-management-layer-active")}function _(){!function(){const e=document.createElement("div");e.classList.add("layer-management-layer"),e.innerText="Layer ",e.dataset.layernum=X.children.length+1;const t=document.createElement("span");t.innerText=`${X.children.length+1}`,e.appendChild(t),X.insertBefore(e,X.firstChild)}(),O(),function(){const e=document.createElement("canvas");e.width=e.height=n.width,e.classList.add("canvas-temp"),e.dataset.canvastempnum=X.children.length-1,document.querySelector(".main-container").appendChild(e);const t=e.getContext("2d"),o=a.getImageData(0,0,n.width,n.height);t.putImageData(o,0,0),a.clearRect(0,0,n.width,n.height);const r=n.toDataURL();localStorage.setItem("url",r)}()}function F(){const e=document.querySelector(".layer-management-layer-active").dataset.layernum,t=document.querySelectorAll(".canvas-temp");if(isCanvasTemp=!1,t.forEach(e=>{e.dataset.canvastempnum==X.children.length&&(isCanvasTemp=!0)}),!isCanvasTemp){const e=document.createElement("canvas");e.width=e.height=n.width,e.classList.add("canvas-temp"),e.dataset.canvastempnum=X.children.length,document.querySelector(".main-container").appendChild(e);const t=e.getContext("2d"),o=a.getImageData(0,0,n.width,n.height);t.putImageData(o,0,0),a.clearRect(0,0,n.width,n.height);const r=n.toDataURL();localStorage.setItem("url",r)}a.clearRect(0,0,n.width,n.height),t.forEach(t=>{t.dataset.canvastempnum==e&&a.drawImage(t,0,0)})}function G(){F();const e=document.querySelector(".layer-management-layer-active"),t=X.children.length,o=e.dataset.layernum,r=document.querySelectorAll(".canvas-temp");if(1===t){a.clearRect(0,0,n.width,n.height);const t=n.toDataURL();return localStorage.setItem("url",t),e.firstElementChild.innerText="1",e.dataset.layernum="1",r.forEach(e=>e.remove()),U(),void Q()}a.clearRect(0,0,n.width,n.height),e.remove(),r.forEach(e=>{e.dataset.canvastempnum==o&&e.remove()}),O()}X.addEventListener("click",function(e){document.querySelectorAll(".layer-management-layer").forEach(t=>{t.classList.contains("layer-management-layer-active")&&t.classList.remove("layer-management-layer-active"),e.target.classList.add("layer-management-layer-active")})}),X.addEventListener("click",F),n.addEventListener("mouseup",function(){const e=document.querySelector(".layer-management-layer-active").dataset.layernum,t=X.children.length,o=document.querySelectorAll(".canvas-temp");e!=t&&o.forEach(t=>{if(t.dataset.canvastempnum==e){const e=t.getContext("2d"),o=a.getImageData(0,0,n.width,n.height);e.putImageData(o,0,0)}})}),j.addEventListener("click",()=>{!function(){const e=document.querySelector(".preview-active").parentNode.previousElementSibling.querySelector(".canvas2"),t=e.getContext("2d"),n=document.querySelectorAll(".canvas-temp");for(let e=0;e<n.length;e++)t.drawImage(n[e],0,0),n[e].remove();const a=e.toDataURL();for(localStorage.setItem("url",a);X.children.length>1;)X.removeChild(X.firstChild);X.firstElementChild.firstElementChild.innerText="1",O()}(),G(),O()}),document.querySelector(".layer-management-btn-container").addEventListener("click",function(e){e.stopPropagation(),e.target.classList.contains("layer-management-btn")&&(e.target.classList.contains("btn-plus")?_():e.target.classList.contains("btn-delete")?G():e.target.classList.contains("btn-up")?function(){const e=document.querySelector(".layer-management-layer-active"),t=(X.children.length,e.dataset.layernum),n=document.querySelector(".main-container"),a=document.querySelectorAll(".canvas-temp");if(e===X.firstElementChild)return;const o=e.previousElementSibling;X.removeChild(e),X.insertBefore(e,o),a.forEach(e=>{if(e.dataset.canvastempnum==t){const t=e.previousElementSibling;n.removeChild(e),n.insertBefore(e,t)}})}():e.target.classList.contains("btn-down")&&function(){const e=document.querySelector(".layer-management-layer-active"),t=(X.children.length,e.dataset.layernum),n=document.querySelector(".main-container"),a=document.querySelectorAll(".canvas-temp");if(e===X.lastElementChild)return;const o=e.nextElementSibling;X.removeChild(o),X.insertBefore(o,e),a.forEach(e=>{if(e.dataset.canvastempnum==t){const t=e.nextElementSibling;n.removeChild(t),n.insertBefore(t,e)}})}())});const H=document.querySelector(".range-fps");H.addEventListener("input",function(){document.querySelector(".fps-value").innerText=H.value}),document.querySelector(".layer-btn").addEventListener("click",function(){const e=document.querySelector(".layer-wrapper");document.fullscreenElement?document.exitFullscreen():e.requestFullscreen()});let W,Z=0;function J(){return 1e3/H.value}function Q(){let e=J();const t=document.querySelectorAll(".canvas2"),n=Y.getContext("2d");n.clearRect(0,0,Y.width,Y.height),n.drawImage(t[Z=++Z%t.length],0,0);const a=document.querySelectorAll(".canvas-temp");for(let e=0;e<a.length;e++)n.drawImage(a[e],0,0);W&&clearInterval(W),W=setTimeout(Q,e)}n.addEventListener("mouseup",Q),H.addEventListener("input",Q);const V=document.querySelector(".range-size");function ee(){return document.querySelector(".size-value").innerText=V.value,V.value}function te(){const e=document.querySelectorAll(".canvas2"),t=[];return e.forEach(e=>{const n=document.createElement("canvas"),a=n.getContext("2d"),o=ee();n.width=o,n.height=o,a.fillStyle="rgba(225,225,225,0.1)",a.fillRect(0,0,n.width,n.height),a.imageSmoothingEnabled=!1,a.drawImage(e,0,0,o,o),t.push(n.toDataURL())}),t}function ne(){const e=[];return document.querySelectorAll(".canvas2").forEach(t=>{t.getContext("2d");const n=document.createElement("canvas"),a=n.getContext("2d"),o=ee();n.width=o,n.height=o,a.imageSmoothingEnabled=!1,a.drawImage(t,0,0,o,o);const r=a.getImageData(0,0,o,o).data.buffer;e.push(r)}),e}V.addEventListener("input",ee),document.querySelector(".save-gif").addEventListener("click",()=>{gifshot.createGIF({images:te(),interval:1/H.value,gifWidth:ee(),gifHeight:ee()},e=>{if(!e.error){const t=e.image;download(t,"newGif.gif","gif")}})}),document.querySelector(".save-apng").addEventListener("click",function(){const e=new Array(ne().length);e.fill(J());const t=UPNG.encode(ne(),ee(),ee(),0,e);download(t,"newAPNG.apng","apng")}),document.querySelector(".save-piskel").addEventListener("click",function(){const e=H.value,t=n.width,a=te().length,o=n.toDataURL(),r=document.querySelectorAll(".canvas2");let c="";for(let e=0;e<a;e++)c+=`${r[e].toDataURL()}, `;download(`${e}, ${t}, ${a}, ${o}, ${c}`,"newPixel.pixel","pixel")}),document.querySelector(".import-pixel").addEventListener("change",function(e){const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=function(e){!function(e){const t=e.split(", "),o=t[0],r=t[1],c=t[2],l=t[3];H.value=o,document.querySelector(".fps-value").innerText=o,n.width=n.height=r,canvas2.width=canvas2.height=r,Y.width=Y.height=r,document.getElementsByName("resize").forEach(e=>{e.checked=!1,e.value==r&&(e.checked=!0,console.log("saveSize"))});const i=new Image;if(i.src=l,i.onload=function(){a.clearRect(0,0,n.width,n.height),a.drawImage(i,0,0,n.width,n.height),console.log(i),U(),Q()},c>1){const e=document.querySelector(".previews-list");for(let n=0;n<c-1;n++){const a=e.lastElementChild.firstElementChild.firstElementChild,o=a.getContext("2d"),r=new Image;r.src=t[4+n],r.onload=function(){o.drawImage(r,0,0)},K()}}}(e.target.result)},o.readAsText(t)},!1),document.querySelector(".import-image").addEventListener("change",function(e){const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=function(e){const t=e.target.result;var o=new Image;o.src=t,o.onload=function(){a.imageSmoothingEnabled=!1,a.clearRect(0,0,n.width,n.height),a.drawImage(o,0,0,n.width,n.height),U(),Q()}},o.readAsDataURL(t)},!1),document.querySelector(".save-png").addEventListener("click",function(){const e=document.querySelectorAll(".canvas2"),t=document.createElement("canvas"),n=t.getContext("2d"),a=ee();t.width=a,t.height=a,n.imageSmoothingEnabled=!1,e.forEach(e=>{n.drawImage(e,0,0,a,a)});const o=t.toDataURL();download(o,"newPng.png","png")});document.querySelector(".save-google-drive").addEventListener("click",e=>{const t=new Array(ne().length);t.fill(J());const a=UPNG.encode(ne(),n.width,n.height,0,t);var o=new Blob([a],{type:"image/apng"}),r=window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,c=new FormData;c.append("metadata",new Blob([JSON.stringify({name:"newPiskel.apng",mimeType:"apng"})],{type:"application/json"})),c.append("file",o),fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{name:"piskel.jpg",method:"POST",headers:new Headers({Authorization:"Bearer "+r}),body:c})});const ae=document.getElementsByName("tool");for(let e=0;e<ae.length;e++)ae[e].onclick=function(){localStorage.setItem("radioTool",this.value)};const oe=document.getElementsByName("resize");for(let e=0;e<oe.length;e++)oe[e].onclick=function(){localStorage.setItem("radioResize",this.value)};const re=document.querySelector(".active-color"),ce=document.querySelector(".prev-color");function le(){const e=document.querySelectorAll(".canvas2"),t=e.length;localStorage.setItem("framesLength",t);for(let n=0;n<t;n++){const t=e[n].toDataURL();localStorage.setItem(n,t)}}re.onchange=function(){localStorage.setItem("activeColor",re.value)},ce.onchange=function(){localStorage.setItem("prevColor",ce.value)},n.onclick=function(){const e=n.toDataURL();localStorage.setItem("url",e)},j.addEventListener("click",le),B.addEventListener("click",le),window.onload=function(){if(localStorage.getItem("radioTool")){const e=localStorage.getItem("radioTool");document.querySelector('input[name="tool"][value="'+e+'"]').setAttribute("checked","checked")}if(localStorage.getItem("radioResize")){const e=localStorage.getItem("radioResize");document.querySelector('input[name="resize"][value="'+e+'"]').setAttribute("checked","checked"),s()}if(localStorage.getItem("activeColor")&&(re.value=localStorage.getItem("activeColor")),localStorage.getItem("prevColor")&&(ce.value=localStorage.getItem("prevColor")),localStorage.getItem("url")){const e=new Image;e.src=localStorage.getItem("url"),e.onload=function(){a.drawImage(e,0,0),U(),Q()}}if(localStorage.getItem("framesLength")){const e=localStorage.getItem("framesLength"),t=document.querySelector(".previews-list");for(let n=0;n<e-1;n++){const e=t.lastElementChild.firstElementChild.firstElementChild.getContext("2d"),a=new Image;a.src=localStorage.getItem(n),a.onload=function(){e.drawImage(a,0,0)},K()}}},document.querySelector(".btn-create").onclick=function(){localStorage.clear()}}]);
//# sourceMappingURL=app.bundle.js.map